--Ejercicio 1: Lista de todos los libros y sus autores

SELECT NAME, TITLE
FROM AUTHOR
INNER JOIN BOOK ON AUTHOR.ID = BOOK.ID;

--Ejercicio 2: Lista de autores y libros publicados después de 2005

SELECT NAME, TITLE,PUBLISH_YEAR
FROM AUTHOR
INNER JOIN BOOK ON AUTHOR.ID = BOOK.ID
WHERE PUBLISH_YEAR > 2025;

--Ejercicio 3: Mostrar libros adaptados en un plazo de 4 años y clasificados por debajo de la adaptación

SELECT BOOK.TITLE, PUBLISH_YEAR, RELEASE_YEAR --COMO TITLE ESTA TANTO EN ADAPTATION COMO EN BOOK, PONEMOS BOOK.TITLE PARA INDICAR QUE ES DE LA TABLA BOOK
FROM BOOK
INNER JOIN ADAPTATION ON BOOK.ID = ADAPTATION.BOOK_ID
WHERE RELEASE_YEAR - PUBLISH_YEAR <= 4 AND ADAPTATION.RATING > BOOK.RATING; --PONEMOS EL PUNTO ADAPTATION Y BOOK PORQUE TIENEN EL MISMO NOMBRE

--Ejercicio 4: Mostrar todos los libros y sus adaptaciones (si las hay)

SELECT BOOK.TITLE, ADAPTATION.TITLE
FROM BOOK
LEFT JOIN ADAPTATION ON BOOK.ID = ADAPTATION.BOOK_ID;


--Ejercicio 5: Mostrar todos los libros y sus adaptaciones cinematográficas

SELECT BOOK.TITLE, ADAPTATION.TITLE, ADAPTATION.TYPE
FROM BOOK
LEFT JOIN ADAPTATION ON BOOK.ID = ADAPTATION.BOOK_ID
WHERE TYPE LIKE 'movie' OR TYPE IS NULL;
